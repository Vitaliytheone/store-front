var custom=new function(){var e=this;e.request=null,e.confirm=function(e,t,a,i){var n;return n=(0,templates["modal/confirm"])($.extend({},!0,{confirm_button:"OK",cancel_button:"Cancel",width:"600px"},i,{title:e,confirm_message:t})),$(window.document.body).append(n),$("#confirmModal").modal({}),$("#confirmModal").on("hidden.bs.modal",function(e){$("#confirmModal").remove()}),$("#confirm_yes").on("click",function(e){return $("#confirm_yes").unbind("click"),$("#confirmModal").modal("hide"),a.call()})},e.ajax=function(t){var a=$.extend({},!0,t);"object"==typeof t&&(t.beforeSend=function(){"function"==typeof a.beforeSend&&a.beforeSend()},t.success=function(e){"function"==typeof a.success&&a.success(e)},null!=e.request&&e.request.abort(),e.request=$.ajax(t))},e.notify=function(e){var t,a;if($("body").addClass("bottom-right"),"object"!=typeof e)return!1;for(t in e)void 0!==(a=$.extend({},!0,{type:"success",delay:8e3,text:""},e[t])).text&&null!=a.text&&$.notify({message:a.text.toString()},{type:a.type,placement:{from:"bottom",align:"right"},z_index:2e3,delay:a.delay,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"}})},e.sendBtn=function(t,a){if("object"!=typeof a&&(a={}),!t.hasClass("active")){t.addClass("has-spinner");var i=$.extend({},!0,a);i.url=t.attr("href"),$(".spinner",t).remove(),t.prepend('<span class="spinner"><i class="fa fa-spinner fa-spin"></i></span>'),i.beforeSend=function(){t.addClass("active")},i.success=function(i){t.removeClass("active"),$(".spinner",t).remove(),"success"==i.status?"function"==typeof a.callback&&a.callback(i):"error"==i.status&&e.notify({0:{type:"danger",text:i.message}})},e.ajax(i)}},e.sendFrom=function(t,a,i){if("object"!=typeof i&&(i={}),!t.hasClass("active")){t.addClass("has-spinner");var n=$.extend({},!0,i),o=$(".error-summary",a);n.url=a.attr("action"),n.type="POST",$(".spinner",t).remove(),t.prepend('<span class="spinner"><i class="fa fa-spinner fa-spin"></i></span>'),n.beforeSend=function(){t.addClass("active"),o.length&&(o.addClass("hidden"),o.html(""))},n.success=function(n){t.removeClass("active"),$(".spinner",t).remove(),"success"==n.status?"function"==typeof i.callback&&i.callback(n):"error"==n.status&&(n.message&&(o.length?(o.html(n.message),o.removeClass("hidden")):e.notify({0:{type:"danger",text:n.message}})),n.errors&&$.each(n.errors,function(e,t){alert(t),a.yiiActiveForm("updateAttribute",e,t)}),"function"==typeof i.errorCallback&&i.errorCallback(n))},e.ajax(n)}},e.generateUrlFromString=function(e){return e.replace(/[^a-z0-9_\-\s]/gim,"").replace(/\s+/g,"-").toLowerCase()},e.generateUniqueUrl=function(e,t){var a,i,n=e;i=1;do{(a=_.find(t,function(e){return e===n}))&&(n=e+"-"+i,i++)}while(a);return n}},customModule={};window.modules={},$(function(){"object"==typeof window.modules&&$.each(window.modules,function(e,t){void 0!==customModule[e]&&customModule[e].run(t)})}),customModule.adminGeneral={run:function(e){$(".edit-seo__title").length>0&&function(){for(var e=$("#store-name"),t=$("#edit-seo__title"),a=t.val(),i=!1,n=["edit-seo__title","edit-seo__meta"],o=0;o<n.length;o++)!function(e){$("."+n[e]+"-muted").text($("#"+n[e]).val().length),$("#"+n[e]).on("input",function(t){$("."+n[e]+"-muted").text($(t.target).val().length),$("."+n[e]).text($(t.target).val())}).trigger("input")}(o);t.on("focus",function(e){i=!0}),e.on("input",function(e){""!==a||i||t.val($(this).val()).trigger("input")})}();var t=$("#delete-modal"),a=t.find("#delete-image");t.on("show.bs.modal",function(e){var t=$(e.relatedTarget).attr("href");a.attr("href",t)}),t.on("hidden.bs.modal",function(){a.attr("href",null)})}},customModule.adminPages={run:function(e){var t,a,i=$("#delete-modal"),n=i.find(".modal-loader");i.find("#feature-delete").on("click",function(){n.removeClass("hidden"),$.ajax({url:t,type:"DELETE",success:function(e,t,i){_.delay(function(){$(location).attr("href",a)},500)},error:function(e,t,a){n.addClass("hidden"),i.modal("hide"),console.log("Error on service save",e,t,a)}})}),i.on("show.bs.modal",function(e){var n=$(e.relatedTarget);t=n.data("action_url"),a=i.data("success_redirect")}),i.on("hidden.bs.modal",function(){t=null})}},customModule.adminPageEdit={run:function(e){function t(e){var t,a=$(e.target).val();t=custom.generateUrlFromString(a),t=custom.generateUniqueUrl(t,s),r.url.val(t).trigger("input"),r.seo_title.val(a).trigger("input")}function a(){r.name.off("input",t),r.seo_title.off("input",t)}var i=$("#pageForm"),n=i.find(".collapse"),o=i.data("new_page"),r={name:i.find(".form_field__name"),content:i.find(".form_field__content"),url:i.find(".form_field__url"),visibility:i.find(".form_field__visibility"),seo_title:i.find(".form_field__seo_title"),seo_description:i.find(".form_field__seo_description")},s=e.urls||[],d=e.url_error||!1;$(".edit-seo__title").length>0&&function(){for(var e=["edit-seo__title","edit-seo__meta","edit-seo__url"],t=0;t<e.length;t++)!function(t){$("."+e[t]+"-muted").text($("#"+e[t]).val().length),$("#"+e[t]).on("input",function(a){2===t?$("."+e[t]).text($(a.target).val().toLowerCase()):($("."+e[t]+"-muted").text($(a.target).val().length),$("."+e[t]).text($(a.target).val()))}).trigger("input")}(t)}(),r.content,r.content.summernote({minHeight:300,focus:!0,toolbar:[["style",["style","bold","italic"]],["lists",["ul","ol"]],["para",["paragraph"]],["color",["color"]],["insert",["link","picture","video"]],["codeview",["codeview"]]],disableDragAndDrop:!0,styleTags:["p","h1","h2","h3","h4","h5","h6"],popover:{image:[["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]]},dialogsFade:!0}),i.keypress(function(e){if(13===e.which)return i.submit(),!1}),d&&n.collapse("show"),o&&(r.name.focus(),r.name.on("input",t),r.url.on("focus",a),r.seo_title.on("focus",a)),r.url.on("input",function(e){var t,a=e.currentTarget,i=$(a),n=i.val(),o=a.selectionStart;(t=custom.generateUrlFromString(n)).length>=200&&(t=t.substring(0,199)),i.val(t),a.selectionEnd=o})}},customModule.adminPayments={run:function(e){$(document).on("change",".toggle-active",function(e){var t=$(e.currentTarget),a=t.data("action_url"),i=(t.data("payment_method"),0|t.prop("checked"));$.ajax({url:a,type:"POST",data:{active:i},success:function(e,t,a){},error:function(e,t,a){console.log("Error on update",e,t,a)}})})}},customModule.adminThemes={run:function(e){var t,a,i=$("#codemirror"),n=$("#modal_submit_close"),o=$("#modal_submit_reset");i.length>0&&(t=CodeMirror.fromTextArea(i[0],{lineNumbers:!0}),a=t.getValue());var r=$("#m_tree_1");r.jstree({core:{themes:{responsive:!1}},types:{default:{icon:"fa fa-folder"},file:{icon:"fa fa-file"}},plugins:["types"]}),r.on("select_node.jstree",function(e,t){var a=t.node;a&&a.hasOwnProperty("a_attr")&&"#"!==a.a_attr.href&&(window.location=a.a_attr.href)}),n.on("show.bs.modal",function(e){var i=$(e.relatedTarget).attr("href");if(void 0===t||t.getValue()===a)return e.stopPropagation(),window.location.href=i,!1;$(this).find(".submit_button").attr("href",i)}),o.on("show.bs.modal",function(e){var t=$(e.relatedTarget).attr("href");$(this).find(".submit_button").attr("href",t)})}},customModule.adminBlocks={run:function(e){$(document).on("change",".change-status",function(e){e.preventDefault();var t=$(this),a=t.data("enable"),i=t.data("disable"),n=void 0;return n=t.prop("checked")?a:i,custom.ajax({url:n}),!1})}},customModule.adminEditBlock={state:{steps:!1,review:!1,slider:!1,feature:!1,actions:{delete:{turn:!1},editorText:{node:!1,nodeText:!1,nodeHeight:!1,save:!1},slider:{link:!1,type:!1},feature:{activeIconId:!1,activeIcon:!1},steps:{activeIconId:!1,activeIcon:!1},dropdown:{id:!1}}},run:function(e){var t=this;switch(void 0!==e.code?e.code:void 0){case"slider":t.slider(e);break;case"features":t.features(e);break;case"review":t.review(e);break;case"process":t.process(e)}t.initTextareaAutosizer()},slider:function(e){var t=this,a=t.state;a.slider=e.block;var i={render:"http://www.mocky.io/v2/5a3d15d8310000471fb593d1",save:e.saveUrl,upload:e.uploadUrl},n=function(){$("textarea.js-auto-size").textareaAutoSize()},o=new Swiper(".block-slider",{pagination:".swiper-pagination",paginationClickable:!0,scrollbarDraggable:!1,simulateTouch:!1}),r=function(e,t,i,r,s,d){var l='<div class="swiper-slide">\n                    <div class="slider__block-wrap slider__block-'+t+' d-flex flex-wrap">\n\n                        <div class="editor-tooltip bg-danger editor-tooltip__right-top editor-action__delete-review editor-action__delete"  data-id="'+t+'" data-type="review" data-toggle="modal" data-target="#delete-feature-modal">\n                            <span class="fa fa-times"></span>\n                        </div>\n                        <div class="col-md-4">\n                            <label for="slider-image-'+t+'" class="slider__image slider__image_'+t+" slider-image-"+t+'" style="background-image: url('+d+');">\n                                <input id="slider-image-'+t+'" type="file" name="slider-image-'+t+'" class="editor-slider-image-input" data-id="'+t+'">\n                            </label>\n                        </div>\n                        <div class="col">\n                            <div class="editor-block__reviev_name">\n                                <div class="editor-textarea__text-edit-off">\n                                    <textarea class="editor-textarea__h text-left editor-textarea__h3 js-auto-size" data-id="'+t+'" data-textarea-title="title" rows="1" spellcheck="false" placeholder="Add title...">'+i+'</textarea>\n                                    <div class="editor-textarea__text-edit-action">\n                                        <button class="btn btn-sm btn-success cursor-pointer editor-textarea__text-edit-save">Save</button>\n                                        <button class="btn btn-sm btn-secondary cursor-pointer editor-textarea__text-edit-close">Close</button>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="editor-block__description">\n                                <div class="editor-textarea__text-edit-off">\n                                    <textarea class="editor_textarea__text js-auto-size" data-id="'+t+'" data-textarea-title="description" rows="1" spellcheck="false" placeholder="Add text...">'+r+'</textarea>\n                                    <div class="editor-textarea__text-edit-action">\n                                        <button class="btn btn-sm btn-success cursor-pointer editor-textarea__text-edit-save">Save</button>\n                                        <button class="btn btn-sm btn-secondary cursor-pointer editor-textarea__text-edit-close">Close</button>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="editor-block__description">\n                                <button class="learn-more learn-more-'+t+'" data-toggle="modal" data-target="#learn-more" data-id="'+t+'">'+s+"</button>\n                            </div>\n                        </div>\n\n                    </div>\n\n                </div>";switch(e){case"render":o.prependSlide(l),o.slideTo(0);break;case"add":o.prependSlide(l),o.slideTo(0),a.slider.data.push({id:t.toString(),title:i,description:r,button:{title:s,link:!1,type:!1},image:!1})}n()},s=function(e){$("#preload").remove();for(i=0;i<e.data.length;i++)r("render",e.data[i].id,e.data[i].title,e.data[i].description,e.data[i].button.title,e.data[i].image);for(var t=$(".slider-effects"),a=$(".slider-interval"),i=0;i<t.length;i++)t[i].value.toLocaleLowerCase()==e.settings.effect.toLocaleLowerCase()&&(t[i].checked=!0,$(t[i].parentNode).addClass("active"));for(i=0;i<a.length;i++)a[i].value.toLocaleLowerCase()==e.settings.rotationInterval.toLocaleLowerCase()&&(a[i].checked=!0,$(a[i].parentNode).addClass("active"))};if($(".new-preview").on("click",function(e){e.preventDefault();var t="";t=0==a.slider.data.length?"1":parseInt(a.slider.data[a.slider.data.length-1].id)+1,r("add",t,"","","Learn more",!1)}),$(document).on("click",".learn-more",function(){var e=$(this).attr("data-id");a.actions.slider.link=e,$(".slider-link__type").addClass("hide-link");for(n=0;n<a.slider.data.length;n++)0==a.slider.data[n].id.indexOf(e)&&($(".learn-more__input").val(a.slider.data[n].button.title),a.actions.slider.type=a.slider.data[n].button.type);for(var t=$("#select-menu__link")[0],i="",n=0;n<a.slider.data.length;n++)0==a.slider.data[n].id.indexOf(a.actions.slider.link)&&(i=a.slider.data[n]);if(i.button.type)for(n=0;n<t.length;n++)t[n].value.toLocaleLowerCase()==i.button.type&&(t[n].selected=!0,$(".slider-link__type-"+i.button.type).removeClass("hide-link"));else t[0].selected=!0;var o=".link-input__"+i.button.type;switch(i.button.type){case"web":$(o).val(i.button.link);break;case"products":case"page":for(n=0;n<o.length;n++)o[n].value==o.button.link&&(t[n].selected=!0)}}),$(document).on("click","#learn-more__save",function(){for(var e=$("#select-menu__link option:selected").val(),t=0;t<a.slider.data.length;t++)if(0==a.slider.data[t].id.indexOf(a.actions.slider.link)){switch(""==$(".learn-more__input").val()?(a.slider.data[t].button.title="Learn more",a.slider.data[t].button.type=!1):(a.slider.data[t].button.title=$(".learn-more__input").val(),a.slider.data[t].button.type=e),e){case"web":a.slider.data[t].button.link=$(".link-input__"+e).val();break;case"products":case"page":var i=".slider-link__type-"+e;a.slider.data[t].button.link=$(i+" option:selected").val();break;case"none":a.slider.data[t].button.link=!1;break;case"home":a.slider.data[t].button.link="/";break;default:console.log("default"),a.slider.data[t].button.link=!1}$(".learn-more-"+a.actions.slider.link).text(a.slider.data[t].button.title)}}),$(document).on("change",".editor-slider-image-input",function(){var e="."+this.id,t=$(this).attr("data-id"),n=new FormData;n.append("file",$(this)[0].files[0]),n.append("type","slider"),$.ajax({url:i.upload,data:n,contentType:!1,processData:!1,type:"POST",success:function(i){if("error"==i.status&&toastr.error(i.error),"success"==i.status){$(e).css("background-image","url("+i.link+")");for(var n=0;n<a.slider.data.length;n++)if(0==a.slider.data[n].id.indexOf(t))return void(a.slider.data[n].image=i.link)}},error:function(e){}})}),$(document).on("click",".editor-action__delete",function(){var e=$(this).attr("data-id");a.actions.delete.turn=e}),$(document).on("click","#feature-delete",function(){for(var e=0;e<a.slider.data.length;e++)if(0==a.slider.data[e].id.indexOf(a.actions.delete.turn))return a.slider.data.splice(e,1),void o.removeSlide(o.activeIndex)}),$(document).on("change",".js-auto-size",function(){for(var e=$(this).attr("data-id"),t=$(this).attr("data-textarea-title"),i=$(this).val(),n=0;n<a.slider.data.length;n++)if(0==a.slider.data[n].id.indexOf(e))return void(a.slider.data[n][t]=i)}),$(document).on("change","#select-menu__link",function(){var e=$(this).find("option:selected").val();$(".slider-link__type").addClass("hide-link"),$(".slider-link__type-"+e).removeClass("hide-link")}),$(document).on("change",".slider-effects",function(){a.slider.settings.effect=$(this).val()}),$(document).on("change",".slider-interval",function(){a.slider.settings.rotationInterval=$(this).val()}),$(document).on("click","#save-changes",function(){$.ajax({url:i.save,data:{content:a.slider},type:"POST",success:function(e){t.saveCallback(e)},error:function(e){toastr.error("Error status "+e.status)}})}),void 0===a.slider)$.ajax({method:"get",url:i.render}).then(function(e){a.slider=e,s(e)}).catch(function(e){$(".prealoder-text").text("Server is not available")});else s(a.slider)},features:function(e){var t=this,a=t.state;a.feature=e.block;var i={render:"http://www.mocky.io/v2/5a4108593200006a18ac345e",save:e.saveUrl,upload:e.uploadUrl},n=function(){$("textarea.js-auto-size").textareaAutoSize()},o=function(e){$("#preload").remove();for(var t=$(".feature-column"),i=$(".feature-align"),o=0;o<t.length;o++)a.feature.settings.column==t[o].value&&(t[o].checked=!0,$(t[o].parentNode).addClass("active"));for(o=0;o<i.length;o++)a.feature.settings.align==i[o].value&&(i[o].checked=!0,$(i[o].parentNode).addClass("active"));$("#feature-fontSize").slider({min:12,max:240,step:12,value:a.feature.settings.iconSize,slide:function(e,t){$(".feature-icon-size-show").text(t.value),$("#feature-size-icon").val(t.value),$(".feature-icon").css({fontSize:t.value+"px"}),a.feature.settings.iconSize=t.value}}),$(".feature-icon-size-show").text(a.feature.settings.iconSize);for(o=0;o<a.feature.data.length;o++)r("render",a.feature.data[o].id,a.feature.data[o].title,a.feature.data[o].description,a.feature.data[o].icon);$("#feature-list").dragsort({dragBetween:!0,dragSelector:".editor-action__drag",placeHolderTemplate:'<li class="col margin-top-bottom editor-placeholder-move"><div class="editor-card editor-tooltip__show placeholder-template d-flex align-items-lg-center justify-content-center"><span>Insert</span></div></li>'}),s(),n()},r=function(e,t,i,n,o){var r=a.feature.settings.iconSize,s='<li class="col-lg-'+a.feature.settings.column+" margin-top-bottom feature-id-"+t+'">\n                    <div class="editor-card editor-tooltip__show">\n                        <div class="row">\n                            <div class="editor-tooltip bg-success editor-tooltip__right-top editor-action__drag">move</div>\n                            <div class="editor-tooltip bg-danger editor-tooltip__left-top editor-action__delete"  data-id="'+t+'" data-type="feature" data-toggle="modal" data-target="#delete-feature-modal">\n                                <span class="fa fa-times"></span>\n                            </div>\n\n                            <div class="editor-card__icon-block col-12">\n                                <div class="editor-preview__block" data-toggle="modal" data-target="#preview-edit-modal" data-id="'+t+'">\n                                    <div class="editor-preview__tooltip">edit</div>\n                                    <span class="fa '+o+' feature-icon" id="feature-icon-'+t+'" style="font-size: '+r+'px;"></span>\n                                </div>\n                            </div>\n                            <div class="editor-card__title-block col-12">\n                                <div class="editor-textarea__text-edit-off">\n                                    <textarea class="editor-textarea__h editor-textarea__h3 js-auto-size" data-id="'+t+'" data-textarea-title="title" rows="1" spellcheck="false" placeholder="Add title...">'+i+'</textarea>\n                                    <div class="editor-textarea__text-edit-action">\n                                        <button class="btn btn-sm btn-success cursor-pointer editor-textarea__text-edit-save">Save</button>\n                                        <button class="btn btn-sm btn-secondary cursor-pointer editor-textarea__text-edit-close">Close</button>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="editor-card__text-block col-12">\n                                <div class="editor_textarea-block">\n                                    <div class="editor-textarea__text-edit-off">\n                                    <textarea class="editor_textarea__text js-auto-size" rows="1" spellcheck="false" data-id="'+t+'" data-textarea-title="description" placeholder="Add text...">'+n+'</textarea>\n                                        <div class="editor-textarea__text-edit-action">\n                                            <button class="btn btn-sm btn-success cursor-pointer editor-textarea__text-edit-save">Save</button>\n                                            <button class="btn btn-sm btn-secondary cursor-pointer editor-textarea__text-edit-close">Close</button>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n\n                        </div>\n                    </div>\n                </li>';$("#feature-list").append(s)},s=function(){$(".feature-title").val(a.feature.header.title),$(".feature-description").val(a.feature.header.description)};if($(document).on("click",".editor-action__delete",function(){var e=$(this).attr("data-id");a.actions.delete.turn=e}),$(document).on("click","#feature-delete",function(){for(var e=0;e<a.feature.data.length;e++)0==a.feature.data[e].id.indexOf(a.actions.delete.turn)&&a.feature.data.splice(e,1);var t=".feature-id-"+a.actions.delete.turn;$(t).remove()}),$(document).on("change",".js-auto-size",function(){var e=$(this).attr("data-id"),t=$(this).attr("data-textarea-title"),i=$(this).val();switch(t){case"header-title":console.log(a.feature.header.title),console.log(i),a.feature.header.title=i;break;case"header-description":a.feature.header.description=i;break;default:for(var n=0;n<a.feature.data.length;n++)if(0==a.feature.data[n].id.indexOf(e))return void(a.feature.data[n][t]=i)}}),$(document).on("change",".feature-align",function(){a.feature.settings.align=$(this).val()}),$(document).on("change",".feature-column",function(){a.feature.settings.column=$(this).val()}),$(document).on("click","#save-changes",function(){$.ajax({url:i.save,data:{content:a.feature},type:"POST",success:function(e){t.saveCallback(e)},error:function(e){}})}),$(document).on("click",".edit-modal__icons-action",function(){$(".edit-modal__icons-action").removeClass("active-icon"),$(this).addClass("active-icon"),a.actions.feature.activeIcon=$(this).attr("data-icon-name")}),$(document).on("click",".editor-preview__block",function(){var e=$(this).attr("data-id");a.actions.feature.activeIconId=e}),$(document).on("click","#feature-saveIcon",function(){for(var e=a.actions.feature.activeIconId,t="#feature-icon-"+e,i="fa "+a.actions.feature.activeIcon+" feature-icon",n=0;n<a.feature.data.length;n++)0==a.feature.data[n].id.indexOf(e)&&(a.feature.data[n].icon=a.actions.feature.activeIcon);$(t).removeAttr("class"),$(t).addClass(i)}),$(document).on("change",".feature-column",function(){$("#feature-list li").removeClass("col-lg-3 col-lg-4 col-lg-6"),$("#feature-list li").addClass("col-lg-"+a.feature.settings.column)}),$(document).on("click","#feature-new",function(){for(var e=0,t=0;t<a.feature.data.length;t++)e<parseInt(a.feature.data[t].id)&&(e=parseInt(a.feature.data[t].id));var i=(++e).toString();a.feature.data.push({id:i,title:"",description:"",icon:"fa-picture-o"}),r("add",i,"","","fa-picture-o")}),void 0===a.feature)$.ajax({method:"get",url:i.render}).then(function(e){a.feature=e,o()}).catch(function(e){console.log(e)});else o(a.feature)},review:function(e){var t=this,a=t.state;a.review=e.block;var i={render:"http://www.mocky.io/v2/5a44a9752e00002c03708668",save:e.saveUrl,upload:e.uploadUrl},n=function(){$("textarea.js-auto-size").textareaAutoSize()},o=new Swiper(".block-slider",{pagination:".swiper-pagination",paginationClickable:!0,scrollbarDraggable:!1,simulateTouch:!1,centeredSlides:!1}),r=function(e){$("#preload").remove(),o=new Swiper(".swiper-container",{pagination:".swiper-pagination",paginationClickable:!0,scrollbarDraggable:!1,centeredSlides:!1,simulateTouch:!1,slidesPerView:parseInt(a.review.settings.column)});for(i=0;i<a.review.data.length;i++)s("render",a.review.data[i].id,a.review.data[i].name,a.review.data[i].rating,a.review.data[i].description,a.review.data[i].image);for(var t=$(".review-column"),i=0;i<t.length;i++)a.review.settings.column==t[i].value&&(t[i].checked=!0,$(t[i].parentNode).addClass("active"));d()},s=function(e,t,i,r,s,d){d||(d="http://www.breps.be/frontend/core/layout/images/default_author_avatar.gif");for(var l="",c=1;c<6;c++)c==parseInt(r)?l+='<input type="radio" name="rating" class="rating" value='+c+" checked/>":l+='<input type="radio" name="rating" class="rating" value='+c+" />";var u='<div class="swiper-slide">\n                        <div class="editor-review__block">\n                            <div class="editor-tooltip bg-danger editor-tooltip__left-top editor-action__delete-review editor-action__delete"  data-id="'+t+'" data-type="review" data-toggle="modal" data-target="#delete-feature-modal">\n                                <span class="fa fa-times"></span>\n                            </div>\n                            <div class="editor-block__review-avatar">\n                                <div class="editor-tooltip bg-danger editor-tooltip__left-top review-image-delete" data-id="'+t+'" data-type="avatar" data-toggle="modal" data-target="#delete-feature-modal">\n                                    <span class="fa fa-times"></span>\n                                </div>\n                                <label for="review-avatar-'+t+'">\n                                    <div class="editor-preview__block-avatar">\n                                        <div style="background-image: url(\''+d+'\');" alt="" title="" class="editor-avatar__image rounded-circle review-avatar-'+t+'"></div>\n                                    </div>\n                                    <input id="review-avatar-'+t+'" type="file" class="editor-preview__avatar-input" data-id="'+t+'">\n                                </label>\n                            </div>\n                            <div class="editor-block__reviev_name">\n                                <div class="editor-textarea__text-edit-off">\n                                    <textarea class="editor-textarea__h editor-textarea__h3 js-auto-size" data-id="'+t+'" data-textarea-title="name" rows="1" spellcheck="false" placeholder="Add name...">'+i+'</textarea>\n                                    <div class="editor-textarea__text-edit-action">\n                                        <button class="btn btn-sm btn-success cursor-pointer editor-textarea__text-edit-save">Save</button>\n                                        <button class="btn btn-sm btn-secondary cursor-pointer editor-textarea__text-edit-close">Close</button>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="editor-rating__block">\n                                <div class="editor-rating_block-stars">\n                                    <div class="star-rating-'+t+'" data-id="'+t+'">\n                                        '+l+'\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="editor-block__description">\n                                <div class="editor-textarea__text-edit-off">\n                                    <textarea class="editor_textarea__text js-auto-size" data-id="'+t+'" data-textarea-title="description" rows="1" spellcheck="false" placeholder="Add text...">'+s+'</textarea>\n                                    <div class="editor-textarea__text-edit-action">\n                                        <button class="btn btn-sm btn-success cursor-pointer editor-textarea__text-edit-save">Save</button>\n                                        <button class="btn btn-sm btn-secondary cursor-pointer editor-textarea__text-edit-close">Close</button>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>';switch(e){case"render":o.prependSlide(u),o.slideTo(0);break;case"add":o.prependSlide(u),o.slideTo(0),a.review.data.push({id:t.toString(),name:i,description:s,image:!1,rating:!1})}n(),$(".star-rating-"+t).rating()},d=function(){$(".review-title").val(a.review.header.title),$(".review-description").val(a.review.header.description)};if($(document).on("change",".js-auto-size",function(){var e=$(this).attr("data-id"),t=$(this).attr("data-textarea-title"),i=$(this).val();switch(t){case"header-title":a.review.header.title=i;break;case"header-description":a.review.header.description=i;break;default:for(var n=0;n<a.review.data.length;n++)if(0==a.review.data[n].id.indexOf(e))return void(a.review.data[n][t]=i)}}),$(document).on("click",".editor-action__delete",function(){var e=$(this).attr("data-id");a.actions.delete.turn=e}),$(document).on("click","#feature-delete",function(){for(var e=0;e<a.review.data.length;e++)if(0==a.review.data[e].id.indexOf(a.actions.delete.turn))return a.review.data.splice(e,1),void o.removeSlide(o.activeIndex)}),$(document).on("change",".review-column",function(){a.review.settings.column=$(this).val(),o=new Swiper(".swiper-container",{pagination:".swiper-pagination",paginationClickable:!0,scrollbarDraggable:!1,centeredSlides:!1,simulateTouch:!1,slidesPerView:parseInt($(this).val())}),n()}),$(document).on("click","#new-review",function(e){e.preventDefault();var t="";t=0==a.review.data.length?"1":parseInt(a.review.data[a.review.data.length-1].id)+1,s("add",t,"","","",!1)}),$(document).on("change",".editor-preview__avatar-input",function(){var e="."+this.id,t=$(this).attr("data-id"),n=new FormData;n.append("file",$(this)[0].files[0]),n.append("type","review"),$.ajax({url:i.upload,data:n,contentType:!1,processData:!1,type:"POST",success:function(i){if("error"==i.status&&(toastr.error(i.error),$(e).css("background-image","url(http://www.breps.be/frontend/core/layout/images/default_author_avatar.gif)")),"success"==i.status)for(var n=0;n<a.review.data.length;n++)if(0==a.review.data[n].id.indexOf(t))return a.review.data[n].image=i.link,void $(e).css("background-image","url("+i.link+")")},error:function(t){$(e).css("background-image","url(http://www.breps.be/frontend/core/layout/images/default_author_avatar.gif)")}})}),$(document).on("click",".review-image-delete",function(){for(var e=$(this).data("id"),t="."+e,i=0;i<a.review.data.length;i++)if(0==a.review.data[i].id.indexOf(e))return a.review.data[i].image=!1,void $(t).css("background-image","url(http://www.breps.be/frontend/core/layout/images/default_author_avatar.gif)")}),$(document).on("click",".fullStar",function(){for(var e=$(this).attr("title"),t=$(this.parentNode.parentNode).attr("data-id"),i=0;i<a.review.data.length;i++)0==a.review.data[i].id.indexOf(t)&&(a.review.data[i].rating=e)}),$(document).on("click","#save-changes",function(){$.ajax({url:i.save,data:{content:a.review},type:"POST",success:function(e){t.saveCallback(e)},error:function(e){}})}),void 0===a.review)$.ajax({method:"get",url:i.render}).then(function(e){a.review=e,r()}).catch(function(e){console.log(e),$(".prealoder-text").text("Server is not available")});else r(a.review)},process:function(e){var t=this,a=t.state;a.steps=e.block;var i={render:"http://www.mocky.io/v2/5a4258c43000000f1a709ddf",save:e.saveUrl,upload:e.uploadUrl},n=function(){$("textarea.js-auto-size").textareaAutoSize()},o=function(e){$("#preload").remove();var t="";t="4"==a.steps.settings.count?a.steps.data.length:a.steps.data.length-1;var i=0;i="3"==a.steps.settings.count?"4":"3";for(o=0;o<t;o++)r("add",a.steps.data[o].id,a.steps.data[o].title,a.steps.data[o].description,a.steps.data[o].icon,i,a.steps.settings.description);a.steps.settings.description&&"false"!=a.steps.settings.description&&$(".steps-description").prop("checked",!0);for(var n=$(".process-count"),o=0;o<n.length;o++)i==n[o].value&&(n[o].checked=!0,$(n[o].parentNode).addClass("active"));s()},r=function(e,t,a,i,o,r,s){var d="";s&&"false"!=s||(d="hide-description");var l='<li class="col-lg-'+r+' margin-top-bottom process-column">\n               <div class="editor-card editor-tooltip__show">\n                   <div class="row">\n                       <div class="editor-card__icon-block col-12">\n                           <div class="editor-preview__block" data-toggle="modal" data-target="#preview-edit-modal" data-id="'+t+'">\n                               <div class="editor-preview__tooltip">edit</div>\n                               <span class="fa '+o+' feature-icon" id="process-icon-'+t+'"></span>\n                           </div>\n                       </div>\n                       <div class="editor-card__title-block col-12">\n                           <div class="editor-textarea__text-edit-off">\n                               <textarea class="editor-textarea__h editor-textarea__h3 js-auto-size" data-id="'+t+'" data-textarea-title="title" rows="1" spellcheck="false" placeholder="Add title...">'+a+'</textarea>\n                               <div class="editor-textarea__text-edit-action">\n                                   <button class="btn btn-sm btn-success cursor-pointer editor-textarea__text-edit-save">Save</button>\n                                   <button class="btn btn-sm btn-secondary cursor-pointer editor-textarea__text-edit-close">Close</button>\n                               </div>\n                           </div>\n                       </div>\n                       <div class="editor-card__text-block col-12 '+d+'">\n                           <div class="editor_textarea-block">\n                               <div class="editor-textarea__text-edit-off">\n                                   <textarea class="editor_textarea__text js-auto-size" data-id="'+t+'" data-textarea-title="description" rows="1" spellcheck="false" placeholder="Add text...">'+i+'</textarea>\n                                   <div class="editor-textarea__text-edit-action">\n                                       <button class="btn btn-sm btn-success cursor-pointer editor-textarea__text-edit-save">Save</button>\n                                       <button class="btn btn-sm btn-secondary cursor-pointer editor-textarea__text-edit-close">Close</button>\n                                   </div>\n                               </div>\n                           </div>\n                       </div>\n                   </div>\n               </div>\n           </li>';$("#process-list").append(l),n()},s=function(){$(".process-title").val(a.steps.header.title),$(".process-description").val(a.steps.header.description),n()};if($(document).on("change",".process-count",function(){if(a.steps.settings.count=$(this).val(),$("#process-list").empty(),4==parseInt(a.steps.settings.count))for(e=0;e<3;e++)r("add",a.steps.data[e].id,a.steps.data[e].title,a.steps.data[e].description,a.steps.data[e].icon,a.steps.settings.count,a.steps.settings.description);else for(var e=0;e<a.steps.data.length;e++)r("add",a.steps.data[e].id,a.steps.data[e].title,a.steps.data[e].description,a.steps.data[e].icon,a.steps.settings.count,a.steps.settings.description)}),$(document).on("change",".steps-description",function(){if(a.steps.settings.description=this.checked,$("#process-list").empty(),this.checked)if(4==parseInt(a.steps.settings.count))for(e=0;e<3;e++)r("add",a.steps.data[e].id,a.steps.data[e].title,a.steps.data[e].description,a.steps.data[e].icon,a.steps.settings.count,a.steps.settings.description);else for(e=0;e<a.steps.data.length;e++)r("add",a.steps.data[e].id,a.steps.data[e].title,a.steps.data[e].description,a.steps.data[e].icon,a.steps.settings.count,a.steps.settings.description);else if(4==parseInt(a.steps.settings.count))for(e=0;e<3;e++)r("add",a.steps.data[e].id,a.steps.data[e].title,a.steps.data[e].description,a.steps.data[e].icon,a.steps.settings.count,a.steps.settings.description);else for(var e=0;e<a.steps.data.length;e++)r("add",a.steps.data[e].id,a.steps.data[e].title,a.steps.data[e].description,a.steps.data[e].icon,a.steps.settings.count,a.steps.settings.description)}),$(document).on("change",".js-auto-size",function(){var e=$(this).attr("data-id"),t=$(this).attr("data-textarea-title"),i=$(this).val();switch(t){case"header-title":a.steps.header.title=i;break;case"header-description":a.steps.header.description=i;break;default:for(var n=0;n<a.steps.data.length;n++)if(0==a.steps.data[n].id.indexOf(e))return void(a.steps.data[n][t]=i)}}),$(document).on("click",".editor-preview__block",function(){var e=$(this).attr("data-id");a.actions.steps.activeIconId=e}),$(document).on("click",".edit-modal__icons-action",function(){$(".edit-modal__icons-action").removeClass("active-icon"),$(this).addClass("active-icon"),a.actions.steps.activeIcon=$(this).attr("data-icon-name")}),$(document).on("click",".editor-preview__block",function(){var e=$(this).attr("data-id");a.actions.steps.activeIconId=e}),$(document).on("click","#feature-saveIcon",function(){for(var e=a.actions.steps.activeIconId,t="#process-icon-"+e,i="fa "+a.actions.steps.activeIcon+" feature-icon",n=0;n<a.steps.data.length;n++)0==a.steps.data[n].id.indexOf(e)&&(a.steps.data[n].icon=a.actions.steps.activeIcon);$(t).removeAttr("class"),$(t).addClass(i)}),$(document).on("click","#save-changes",function(){$.ajax({url:i.save,data:{content:a.steps},type:"POST",success:function(e){t.saveCallback(e)},error:function(e){toastr.error("Error status "+e.status)}})}),void 0===a.steps)$.ajax({method:"get",url:i.render}).then(function(e){a.steps=e,o()}).catch(function(e){$(".prealoder-text").text("Server is not available"),toastr.error("Error")});else o(a.steps)},initTextareaAutosizer:function(){var e=this;$(document).on("keydown",".js-auto-size",function(t){t.ctrlKey&&13==t.keyCode&&(e.state.actions.editorText.save=!0,$(e.state.actions.editorText.node).blur())}),$(document).on("focus",".js-auto-size",function(){e.state.actions.editorText.node=this,e.state.actions.editorText.nodeText=this.value,e.state.actions.editorText.nodeHeight=this.style.height;var t=this.parentNode,a=e.state.actions.editorText.node,i=e.state.actions.editorText.nodeHeight,n=e.state.actions.editorText.nodeText;$(t).removeClass("editor-textarea__text-edit-off").addClass("editor-textarea__text-edit-on"),$(document).on("click",".editor-textarea__text-edit-close",function(){a.value=n,a.style.height=i,$(".js-auto-size").blur(),$(t).removeClass("editor-textarea__text-edit-on").addClass("editor-textarea__text-edit-off")}),$(".editor-textarea__text-edit-save").on("mousedown",function(){e.state.actions.editorText.save=!0,$(e.state.actions.editorText.node).blur()})}),$(document).on("focusout",".js-auto-size",function(){var t=e.state.actions.editorText.node,a=t.parentNode;e.state.actions.editorText.save?e.state.actions.editorText.save=!1:(t.value=e.state.actions.editorText.nodeText,t.style.height=e.state.actions.editorText.nodeHeight),$(a).removeClass("editor-textarea__text-edit-on").addClass("editor-textarea__text-edit-off")})},saveCallback:function(e){void 0!==e.status&&("success"==e.status&&toastr.success("Success"),"error"==e.status&&toastr.error(e.error))}},customModule.adminLayout={run:function(e){$(".dropdown-collapse").on("click",function(e){e.preventDefault(),e.stopPropagation(),$(this).next().hasClass("show")?$($(this).attr("href")).collapse("hide"):$($(this).attr("href")).collapse("show")});var t=document.querySelectorAll(".inputfile");Array.prototype.forEach.call(t,function(e){e.nextElementSibling.innerHTML;e.addEventListener("change",function(e){if((this.files&&this.files.length>1?(this.getAttribute("data-multiple-caption")||"").replace("{count}",this.files.length):e.target.value.split("\\").pop())&&this.files&&this.files[0]){var t=new FileReader;t.onload=function(e){var t='<div class="sommerce-settings__theme-imagepreview">\n                              <a href="#" class="sommerce-settings__delete-image"><span class="fa fa-times-circle-o"></span></a>\n                              <img src="'+e.target.result+'" alt="...">\n                          </div>';$("#image-preview").html(t)},t.readAsDataURL(this.files[0])}}),$(document).on("click",".sommerce_v1.0-settings__delete-image",function(t){$("#image-preview").html("<span></span>"),e.value=""})}),$('[data-toggle="tooltip"]').tooltip()}},customModule.adminNotifyLayout={run:function(e){toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-bottom-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"5000",timeOut:"5000",extendedTimeOut:"5000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};e.messages;e.messages&&_.forEach(e.messages,function(e){e.success&&toastr.success(e.success),e.warning&&toastr.warning(e.warning),e.error&&toastr.error(e.error)})}},customModule.ordersDetails={run:function(e){$(document).ready(function(){var e=$("#suborder-details-modal"),t=e.find(".modal-title"),a=e.find("#order-detail-provider"),i=e.find("#order-detail-provider-order-id"),n=e.find("#order-detail-provider-response"),o=e.find("#order-detail-lastupdate"),r=e.find(".modal-loader");e.on("show.bs.modal",function(e){function s(e){t.html(c),a.val(e.provider),i.val(e.provider_order_id),n.html(e.provider_response),o.val(e.updated_at)}var d=$(e.relatedTarget),l=d.data("suborder-id"),c=d.data("modal_title");void 0===l||isNaN(l)||(r.removeClass("hidden"),$.ajax({url:"/admin/orders/get-order-details",type:"GET",data:{suborder_id:l},success:function(e){r.addClass("hidden"),void 0!==e.details&&s(e.details)},error:function(e,t,a){console.log("Something is wrong!"),console.log(e,t,a),r.addClass("hidden")}}))}),e.on("hidden.bs.modal",function(e){$(e.currentTarget).find("input").val(""),n.html("")})})}},customModule.ordersClipboard={run:function(e){var t=e.messageCopied||"Copied!";$(document).ready(function(){var e=function(){var e=function(){new Clipboard("[data-clipboard=true]").on("success",function(e){e.clearSelection(),void 0===toastr?alert("Copied!"):(toastr.options={positionClass:"toast-bottom-right"},toastr.success(t))})};return{init:function(){e()}}}();jQuery(document).ready(function(){e.init()})})}},customModule.payments={run:function(e){var t=$(".payments_detail"),a=t.find(".modal-title"),i=t.find(".details-container"),n=t.find(".modal-loader");t.on("show.bs.modal",function(e){function o(e){a.html(d),_.each(e,function(e){i.append('<pre class="sommerce-pre details-item">'+e.time+"<br><br>"+e.data+"</pre>")})}var r=$(e.relatedTarget),s=r.data("id"),d=r.data("modal_title"),l=r.data("action_url");void 0!==s&&void 0!==l&&(n.removeClass("hidden"),$.ajax({url:l,type:"GET",success:function(e){n.addClass("hidden"),void 0!==e&&o(e)},error:function(e,a,i){console.log("Something is wrong!"),console.log(e,a,i),n.addClass("hidden"),t.modal("hide")}}))}),t.on("hidden.bs.modal",function(e){a.html(""),i.empty()})}},customModule.adminProviders={run:function(e){$(document).on("click","#showCreateProviderModal",function(e){e.preventDefault();$(this);var t=$("#createProviderModal"),a=$("#createProviderForm",t),i=$("#createProviderError",a);return i.addClass("hidden"),i.html(""),t.modal("show"),!1}),$(document).on("click","#createProviderButton",function(e){e.preventDefault();var t=$(this),a=$("#createProviderForm");return custom.sendFrom(t,a,{data:a.serialize(),callback:function(e){$("#createProviderModal").modal("hide"),location.reload()}}),!1})}};