var custom=new function(){var a=this;a.request=null,a.confirm=function(e,t,n,o,i){var a;return a=(0,templates["modal/confirm"])($.extend({},!0,{confirm_button:"OK",cancel_button:"Cancel",width:"600px"},n,{title:e,confirm_message:t})),$(window.document.body).append(a),$("#confirmModal").modal({}),$("#confirmModal").on("hidden.bs.modal",function(e){if($("#confirmModal").remove(),"function"==typeof i)return i.call()}),$("#confirm_yes").on("click",function(e){return $("#confirm_yes").unbind("click"),$("#confirmModal").modal("hide"),o.call()})},a.ajax=function(e){var t=$.extend({},!0,e);"object"==typeof e&&(e.beforeSend=function(){"function"==typeof t.beforeSend&&t.beforeSend()},e.success=function(e){"function"==typeof t.success&&t.success(e)},null!=a.request&&a.request.abort(),a.request=$.ajax(e))},a.notify=function(e){var t,n;if($("body").addClass("bottom-right"),"object"!=typeof e)return!1;for(t in e)void 0!==(n=$.extend({},!0,{type:"success",delay:8e3,text:""},e[t])).text&&null!=n.text&&$.notify({message:n.text.toString()},{type:n.type,placement:{from:"bottom",align:"right"},z_index:2e3,delay:n.delay,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"}})},a.sendBtn=function(t,n){if("object"!=typeof n&&(n={}),!t.hasClass("active")){t.addClass("has-spinner");var e=$.extend({},!0,n);e.url=t.attr("href"),$(".spinner",t).remove(),t.prepend('<span class="spinner"><i class="fa fa-spinner fa-spin"></i></span>'),e.beforeSend=function(){t.addClass("active")},e.success=function(e){t.removeClass("active"),$(".spinner",t).remove(),"success"==e.status?"function"==typeof n.callback&&n.callback(e):"error"==e.status&&a.notify({0:{type:"danger",text:e.message}})},a.ajax(e)}},a.sendFrom=function(t,n,o){if("object"!=typeof o&&(o={}),!t.hasClass("active")){t.addClass("has-spinner");var e=$.extend({},!0,o),i=$(".error-summary",n);e.url=n.attr("action"),e.type="POST",$(".spinner",t).remove(),t.prepend('<span class="spinner"><i class="fa fa-spinner fa-spin"></i></span>'),e.beforeSend=function(){t.addClass("active"),i.length&&(i.addClass("hidden"),i.html(""))},e.success=function(e){t.removeClass("active"),$(".spinner",t).remove(),"success"==e.status?"function"==typeof o.callback&&o.callback(e):"error"==e.status&&(e.message&&(i.length?(i.html(e.message),i.removeClass("hidden")):a.notify({0:{type:"danger",text:e.message}})),e.errors&&$.each(e.errors,function(e,t){alert(t),n.yiiActiveForm("updateAttribute",e,t)}),"function"==typeof o.errorCallback&&o.errorCallback(e))},a.ajax(e)}},a.generateUrlFromString=function(e){var t=e.replace(/[^a-z0-9_\-\s]/gim,"").replace(/\s+/g,"-").toLowerCase();return"-"!==t&&"_"!==t||(t=""),t},a.generateUniqueUrl=function(e,t){var n,o,i=e;for(o=1;(n=_.find(t,function(e){return e===i}))&&(i=e+"-"+o,o++),n;);return i}},customModule={};window.modules={},$(function(){"object"==typeof window.modules&&$.each(window.modules,function(e,t){void 0!==customModule[e]&&customModule[e].run(t)})});var templates={};templates["checkout/checkbox"]=_.template('<div class="form-group fields" id="order_<%= name %>">\n    <label class="control-label" for="field-<%= name %>"><%= label %></label><br>\n    <input name="fields[<%= name %>]" value="0" type="hidden"/>\n    <input name="fields[<%= name %>]" value="1" type="checkbox" id="field-<%= name %>"/>\n</div>'),templates["checkout/description"]=_.template('<div class="form-group fields" id="order_<%= name %>">\n    <label class="control-label" for="field-<%= name %>"><%= label %></label>\n    <div class="panel-body border-solid border-rounded text-center"><%= value %></div>\n</div>'),templates["checkout/hidden"]=_.template('<input class="fields" name="fields[<%= name %>]" value="<%= value %>" type="hidden" id="field-<%= name %>"/>'),templates["checkout/input"]=_.template('<div class="form-group fields" id="order_<%= name %>">\n    <label class="control-label" for="field-<%= name %>"><%= label %></label>\n    <input class="form-control" name="fields[<%= name %>]" value="<%= value %>" type="text" id="field-<%= name %>"/>\n</div>'),templates["checkout/stripe_payment_request_btn"]=_.template('<span id="<%= id %>" style="width: 150px; height: 18px; display: inline-block;" class="hidden"></span>'),templates["modal/confirm"]=_.template('<div class="modal fade confirm-modal" id="confirmModal" tabindex="-1" data-backdrop="static">\n    <div class="modal-dialog modal-md" role="document">\n        <div class="modal-content">\n            <% if (typeof(confirm_message) !== "undefined" && confirm_message != \'\') { %>\n            <div class="modal-header">\n                <h3 id="conrirm_label"><%= title %></h3>\n                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><span aria-hidden="true">&times;</span></button>\n            </div>\n\n            <div class="modal-body">\n                <p><%= confirm_message %></p>\n            </div>\n\n\n            <div class="modal-footer justify-content-start">\n                <button class="btn btn-primary m-btn--air" id="confirm_yes"><%= confirm_button %></button>\n                <button class="btn btn-secondary m-btn--air" data-dismiss="modal" aria-hidden="true"><%= cancel_button %></button>\n            </div>\n            <% } else { %>\n            <div class="modal-body">\n                <div class="text-center">\n                    <h3 id="conrirm_label"><%= title %></h3>\n                </div>\n\n                <div class="text-center">\n                    <button class="btn btn-primary m-btn--air" id="confirm_yes"><%= confirm_button %></button>\n                    <button class="btn btn-secondary m-btn--air" data-dismiss="modal" aria-hidden="true"><%= cancel_button %></button>\n                </div>\n            </div>\n            <% } %>\n        </div>\n    </div>\n</div>'),customModule.adminPages={run:function(e){var n,o,i=$("#delete-modal"),a=i.find(".modal-loader");i.find("#feature-delete").on("click",function(){a.removeClass("hidden"),$.ajax({url:n,type:"DELETE",success:function(e,t,n){_.delay(function(){$(location).attr("href",o)},500)},error:function(e,t,n){a.addClass("hidden"),i.modal("hide"),console.log("Error on service save",e,t,n)}})}),i.on("show.bs.modal",function(e){var t=$(e.relatedTarget);n=t.data("action_url"),o=i.data("success_redirect")}),i.on("hidden.bs.modal",function(){n=null})}},customModule.adminPageEdit={run:function(e){var t=$("#pageForm"),n=(t.find("submit"),t.find(".collapse")),o=t.find(".modal-loader"),i=t.find(".error-summary"),a=t.data("new_page"),s={name:t.find(".form_field__name"),content:t.find(".form_field__content"),url:t.find(".form_field__url"),visibility:t.find(".form_field__visibility"),seo_title:t.find(".form_field__seo_title"),seo_description:t.find(".form_field__seo_description")},r=e.pageId||void 0,l=e.urls||[],d=e.url_error||!1;function c(e){var t,n=$(e.target).val();t=custom.generateUrlFromString(n),t=custom.generateUniqueUrl(t,l),s.url.val(t).trigger("input"),s.seo_title.val(n).trigger("input")}function u(){s.name.off("input",c),s.seo_title.off("input",c)}0<$(".edit-seo__title").length&&function(){for(var n=["edit-seo__title","edit-seo__meta","edit-seo__url"],e=function(t){$("."+n[t]+"-muted").text($("#"+n[t]).val().length),$("#"+n[t]).on("input",function(e){2===t?$("."+n[t]).text($(e.target).val().toLowerCase()):($("."+n[t]+"-muted").text($(e.target).val().length),$("."+n[t]).text($(e.target).val()))}).trigger("input")},t=0;t<n.length;t++)e(t)}(),function(e){if(!s.content.length)return;s.content.summernote({minHeight:300,focus:!0,toolbar:[["style",["style","bold","italic"]],["lists",["ul","ol"]],["para",["paragraph"]],["color",["color"]],["insert",["link","picture","video"]],["codeview",["codeview"]]],disableDragAndDrop:!0,styleTags:["p","h1","h2","h3","h4","h5","h6"],popover:{image:[["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]]},dialogsFade:!0}),t.keypress(function(e){if(13===e.which)return t.submit(),!1})}(s.content),d&&n.collapse("show"),a&&(s.name.focus(),s.name.on("input",c),s.url.on("focus",u),s.seo_title.on("focus",u)),s.url.on("input",function(e){var t,n=e.currentTarget,o=$(n),i=o.val(),a=n.selectionStart;200<=(t=custom.generateUrlFromString(i)).length&&(t=t.substring(0,199));o.val(t),n.selectionEnd=a});var f=t.attr("action");toastr.options={positionClass:"toast-bottom-right",preventDuplicates:!1},t.submit(function(e){e.preventDefault(),o.removeClass("hidden"),i.addClass("hidden"),$.ajax({url:f,type:"POST",data:$(this).serialize(),success:function(e,t,n){if(o.addClass("hidden"),!0===e.success){if(void 0!==e.redirect)return void(window.location.href=e.redirect);void 0!==e.message&&toastr.success(e.message),void 0===r&&void 0!==e.id&&(r=e.id,f=f+"?id="+r)}!1===e.success&&void 0!==e.message&&(i.removeClass("hidden"),i.html(e.message))},error:function(e,t,n){o.addClass("hidden"),console.log("Error on create/update page!",e,t,n)}}),i.empty()})}},customModule.adminPayments={run:function(e){$(document).on("change",".toggle-active",function(e){var t=$(e.currentTarget),n=t.data("action_url"),o=0|t.prop("checked");$.ajax({url:n,type:"POST",data:{active:o},success:function(e,t,n){},error:function(e,t,n){console.log("Error on update",e,t,n)}})})}},customModule.adminThemes={run:function(e){var n,o,t=e.extension||null,i=$("#code"),a={};switch(t){case"twig":a={mode:"text/html",lineNumbers:!0,profile:"xhtml",lineWrapping:!0,extraKeys:{"Ctrl-Q":function(e){e.foldCode(e.getCursor())}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]};break;case"css":a={mode:"text/css",lineNumbers:!0,lineWrapping:!0,extraKeys:{"Ctrl-Q":function(e){e.foldCode(e.getCursor())}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]};break;case"js":a={mode:"text/javascript",lineNumbers:!0,lineWrapping:!0,extraKeys:{"Ctrl-Q":function(e){e.foldCode(e.getCursor())}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]};break;default:a={lineNumbers:!0,lineWrapping:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]}}0<i.length&&(n=CodeMirror.fromTextArea(i[0],a),o=n.getValue());var s=$("#m_tree_1");s.jstree({core:{themes:{responsive:!1}},types:{default:{icon:"fa fa-folder"},file:{icon:"fa fa-file"}},plugins:["types"]}),s.on("select_node.jstree",function(e,t){var n=t.node;n&&n.hasOwnProperty("a_attr")&&"#"!==n.a_attr.href&&(window.location=n.a_attr.href)}),toastr.options={positionClass:"toast-bottom-right",preventDuplicates:!1};var r=$("#edit_theme_form"),l=$("#reset_file"),d=r.find(".modal-loader"),c=r.attr("action");r.submit(function(e){e.preventDefault(),d.removeClass("hidden"),$.ajax({url:c,type:"POST",data:$(this).serialize(),success:function(e,t,n){if(d.addClass("hidden"),!0===e.success){if(e.filename){var o=s.jstree(!0).get_node(e.filename),i=s.jstree(!0).get_node(e.filename,!0);s.jstree(!0).set_icon(o,"fa fa-file"),e.modified_at&&i&&i.find("a.jstree-anchor").prepend(e.modified_at)}e.resetable&&l.removeClass("d-none"),void 0!==e.message&&toastr.success(e.message)}},error:function(e,t,n){d.addClass("hidden"),console.log("Error on service save",e,t,n)}})}),$("#modal_submit_close").on("show.bs.modal",function(e){var t=$(e.relatedTarget).attr("href");if(void 0===n||n.getValue()===o)return e.stopPropagation(),window.location.href=t,!1;$(this).find(".submit_button").attr("href",t)}),$("#modal_submit_reset").on("show.bs.modal",function(e){var t=$(e.relatedTarget).attr("href");$(this).find(".submit_button").attr("href",t)})}},customModule.adminLayout={run:function(e){$(".dropdown-collapse").on("click",function(e){e.preventDefault(),e.stopPropagation(),$(this).next().hasClass("show")?$($(this).attr("href")).collapse("hide"):$($(this).attr("href")).collapse("show")});var t=document.querySelectorAll(".inputfile");Array.prototype.forEach.call(t,function(t){t.nextElementSibling.innerHTML;t.addEventListener("change",function(e){if((this.files&&1<this.files.length?(this.getAttribute("data-multiple-caption")||"").replace("{count}",this.files.length):e.target.value.split("\\").pop())&&this.files&&this.files[0]){var t=new FileReader;t.onload=function(e){var t='<div class="gateway-settings__theme-imagepreview">\n                              <a href="#" class="gateway-settings__delete-image"><span class="fa fa-times-circle-o"></span></a>\n                              <img src="'+e.target.result+'" alt="...">\n                          </div>';$("#image-preview").html(t)},t.readAsDataURL(this.files[0])}}),$(document).on("click",".gateway_v1.0-settings__delete-image",function(e){$("#image-preview").html("<span></span>"),t.value=""})}),$('[data-toggle="tooltip"]').tooltip()}},customModule.adminNotifyLayout={run:function(e){var t=this;toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-bottom-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"5000",timeOut:"5000",extendedTimeOut:"5000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};e.messages;e.messages&&_.forEach(e.messages,function(e){t.send(e)})},send:function(e){e.success&&toastr.success(e.success),e.warning&&toastr.warning(e.warning),e.error&&toastr.error(e.error)}},customModule.paymentsCheckout={fieldsOptions:void 0,fieldsContainer:void 0,run:function(e){var t=this;t.fieldsContainer=$("form"),t.fieldOptions=e.fieldOptions,void 0!==(t.params=e).options&&void 0!==e.options.stripe&&t.initStripe(e.options.stripe),t.updateFields()},updateFields:function(){var e=this;if($("button[type=submit]",e.fieldsContainer).show(),$(".fields",e.fieldsContainer).remove(),$("input,select",e.fieldsContainer).prop("disabled",!1),void 0!==e.fieldOptions&&e.fieldOptions){var n=[],o=templates["checkout/input"],i=templates["checkout/hidden"],a=templates["checkout/checkbox"];$.each(e.fieldOptions,function(e,t){void 0!==t&&null!=t&&t&&("input"==t.type&&n.push(o(t)),"hidden"==t.type&&n.push(i(t)),"checkbox"==t.type&&n.push(a(t)))}),$("input",e.fieldsContainer).last().after(n.join("\r\n"))}},initStripe:function(e){var t=this,n=StripeCheckout.configure($.extend({},!0,e.configure,{token:function(e){$("#field-token").val(e.id),$("#field-email").val(e.email),t.fieldsContainer.submit()}}));n.open(e.open),$(window).on("popstate",function(){n.close()})}};